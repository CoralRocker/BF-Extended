#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <string.h>


char* rootDir(FILE* f, char* strname);
FILE* rootFile(FILE* f, char* strname, char* relativePath
		);

int main(int argc, char** argv){
	FILE* f = fopen(argv[1],"r");
	char* fdir = rootDir(f, argv[1] );
	puts(fdir);
	free(fdir);
	fclose(f);
}

char* rootDir(FILE* f, char* strname){
	int file_descriptor = fileno(f);
	char* dirname = malloc(1024);
	char fdpath[1024];
	ssize_t n;
	sprintf(fdpath, "/proc/self/fd/%d", file_descriptor);
	n = readlink(fdpath, dirname, 1024);
	if(n < 0)
		return NULL;
	dirname[n] = 0x0;
	
	int strLen = strlen(strname);
	for(int i = n - strLen; i < n; i++)
		dirname[i]=0x0;
	printf("N: %d, STRLEN: %d\n", n, strlen(dirname));

	return dirname;
}

FILE* rootFile(FILE* f, char* strname, char* relativePath){

	return dirname;
}
